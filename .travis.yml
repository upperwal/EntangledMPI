sudo: required

language: c

services: docker

os:
  - linux
compiler:
  - gcc

addons:
    # For Linux, make sure we have some extra packages that we like to
    # build with
    apt:
        packages:
            - autoconf
            - automake
            - libtool

cache:
  directories:
    - openmpi
    - openmpi-3.0.1

# upgrade packages
#before_install:
#  - test -n $CC && unset CC
#  - test -n $CXX && unset CXX

# install mpi
install:
  - bash ci/travis/install_mpi.sh
  - export PATH=$TRAVIS_BUILD_DIR/openmpi/bin:$PATH
  - export LD_LIBRARY_PATH=$TRAVIS_BUILD_DIR/openmpi/lib:$LD_LIBRARY_PATH
  - echo $PATH

before_script:
  - ./autogen.sh
  - mkdir build
  - cd build


# build instructions
script:
  - ../configure --disable-stack-protector
  - make -j 4 CC=mpicc